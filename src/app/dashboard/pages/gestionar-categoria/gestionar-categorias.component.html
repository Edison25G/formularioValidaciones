<p-toast></p-toast>

<div class="p-6">
	<div>
		<!-- Título + Botón Limpiar -->
		<div class="flex justify-between items-center mb-6">
			<h2 class="text-2xl font-bold text-gray-800">
				{{ editando ? 'Editar Categoría' : 'Crear Nueva Categoría' }}
			</h2>

			<p-button
				icon="pi pi-filter-slash"
				label="Limpiar"
				severity="secondary"
				outlined
				size="small"
				(click)="resetFormulario()"
			></p-button>
		</div>

		<!-- Formulario -->
		<form [formGroup]="formCategoria" (ngSubmit)="guardarCategoria()" class="space-y-6">
			<div>
				<span class="block text-sm font-semibold mb-1">Nombre</span>
				<input pInputText formControlName="name" class="w-full" placeholder="Ej. Ahorro" />
			</div>

			<div>
				<span class="block text-sm font-semibold mb-1">Slug</span>
				<input pInputText formControlName="slug" class="w-full" placeholder="Ej. ahorro" />
				<small class="text-gray-500">Usa letras minúsculas y guiones. Ej: plan-estrategico</small>
			</div>

			<div>
				<span class="block text-sm font-semibold mb-1">Ícono</span>
				<p-select
					[options]="iconosDisponibles"
					formControlName="icon"
					placeholder="Selecciona un ícono"
					optionLabel="label"
					optionValue="value"
					class="w-full"
					[filter]="true"
					[showClear]="true"
				>
					<ng-template let-option pTemplate="item">
						<div class="flex items-center gap-2">
							<i [class]="option.value"></i>
							<span>{{ option.label }}</span>
						</div>
					</ng-template>
				</p-select>
			</div>

			<div class="flex justify-end">
				<p-button
					type="submit"
					[label]="editando ? 'Actualizar' : 'Crear Categoría'"
					[icon]="editando ? 'pi pi-refresh' : 'pi pi-save'"
					class="p-button-success"
					[disabled]="formCategoria.invalid"
				></p-button>
			</div>
		</form>
	</div>

	<!-- Tabla de categorías -->
	<div>
		<h3 class="text-xl font-semibold mb-4">Categorías existentes</h3>
		<p-table [value]="categorias" [paginator]="true" [rows]="5" responsiveLayout="scroll">
			<ng-template pTemplate="header">
				<tr>
					<th>Ícono</th>
					<th>Nombre</th>
					<th>Slug</th>
					<th class="text-center">Acciones</th>
				</tr>
			</ng-template>

			<ng-template pTemplate="body" let-cat>
				<tr>
					<td><i [class]="cat.icon"></i></td>
					<td>{{ cat.name }}</td>
					<td>{{ cat.slug }}</td>
					<td class="text-center space-x-2">
						<p-button icon="pi pi-pencil" rounded outlined size="small" (click)="editar(cat)"></p-button>
						<p-button
							icon="pi pi-trash"
							severity="danger"
							rounded
							outlined
							size="small"
							pTooltip="Eliminar"
							tooltipPosition="top"
							(click)="eliminar(cat)"
						></p-button>
					</td>
				</tr>
			</ng-template>
		</p-table>
	</div>
</div>
